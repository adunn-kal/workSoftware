<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>WaterSense: STM32Encoder Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="wave.png"/></td>
  <td id="projectalign">
   <div id="projectname">WaterSense<span id="projectnumber">&#160;0.1</span>
   </div>
   <div id="projectbrief">Firmware to measure waves and tides in marine environments.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('class_s_t_m32_encoder.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="class_s_t_m32_encoder-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">STM32Encoder Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Class which operates an STM32 timer in quadrature encoder mode.  
 <a href="class_s_t_m32_encoder.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="encoder__counter_8h_source.html">encoder_counter.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:af12a9e4c2a45e9d096d0611a0cbc7589"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_s_t_m32_encoder.html#af12a9e4c2a45e9d096d0611a0cbc7589">STM32Encoder</a> (TIM_TypeDef *timer, uint8_t pin1, uint8_t pin2)</td></tr>
<tr class="memdesc:af12a9e4c2a45e9d096d0611a0cbc7589"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set up an STM32 timer to read a quadrature encoder.  <a href="class_s_t_m32_encoder.html#af12a9e4c2a45e9d096d0611a0cbc7589">More...</a><br /></td></tr>
<tr class="separator:af12a9e4c2a45e9d096d0611a0cbc7589"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa81c6d6736667b165ccf81f1f417dc8"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_s_t_m32_encoder.html#aaa81c6d6736667b165ccf81f1f417dc8">getCount</a> (void)</td></tr>
<tr class="memdesc:aaa81c6d6736667b165ccf81f1f417dc8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the current position count from the timer.  <a href="class_s_t_m32_encoder.html#aaa81c6d6736667b165ccf81f1f417dc8">More...</a><br /></td></tr>
<tr class="separator:aaa81c6d6736667b165ccf81f1f417dc8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1b3a03d36f25377333a24a5b6346219"><td class="memItemLeft" align="right" valign="top"><a id="af1b3a03d36f25377333a24a5b6346219" name="af1b3a03d36f25377333a24a5b6346219"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>zero</b> (void)</td></tr>
<tr class="memdesc:af1b3a03d36f25377333a24a5b6346219"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the counter reading to zero. <br /></td></tr>
<tr class="separator:af1b3a03d36f25377333a24a5b6346219"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67f9555e6838296b6533f6ab71a0530e"><td class="memItemLeft" align="right" valign="top"><a id="a67f9555e6838296b6533f6ab71a0530e" name="a67f9555e6838296b6533f6ab71a0530e"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>pause</b> (void)</td></tr>
<tr class="memdesc:a67f9555e6838296b6533f6ab71a0530e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pause the counter so it won't update its count until resumed. <br /></td></tr>
<tr class="separator:a67f9555e6838296b6533f6ab71a0530e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9133c7ac41f4ca78b59947dce1070a8"><td class="memItemLeft" align="right" valign="top"><a id="ab9133c7ac41f4ca78b59947dce1070a8" name="ab9133c7ac41f4ca78b59947dce1070a8"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>resume</b> (void)</td></tr>
<tr class="memdesc:ab9133c7ac41f4ca78b59947dce1070a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resume the counter so it will update its count when the encoder is moved. <br /></td></tr>
<tr class="separator:ab9133c7ac41f4ca78b59947dce1070a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-attribs" name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:ab8d5bacd29d76145a90f38dfbdf50138"><td class="memItemLeft" align="right" valign="top"><a id="ab8d5bacd29d76145a90f38dfbdf50138" name="ab8d5bacd29d76145a90f38dfbdf50138"></a>
HardwareTimer *&#160;</td><td class="memItemRight" valign="bottom"><b>p_timer</b></td></tr>
<tr class="memdesc:ab8d5bacd29d76145a90f38dfbdf50138"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer to the timer/counter to be used. <br /></td></tr>
<tr class="separator:ab8d5bacd29d76145a90f38dfbdf50138"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Class which operates an STM32 timer in quadrature encoder mode. </p>
<p >This class sets up a timer/counter which is capable of reading quadrature signals from an incremental encoder and provides a method for retrieving a count which corresponds to the encoder's position. The position will overflow, and this class doesn't deal with that &ndash; the user must periodically read the position and use it to update a position count with a large enough bit width that the full position reading does not overflow.</p>
<p >So far this class has been tested with the following timers and pins on an STM32L476RG:</p><ul>
<li>Timer <code>TIM2</code> using pins <code>PA0</code> and <code>PA1</code> </li>
<li>Timer <code>TIM3</code> using pins <code>PB4</code> and <code>PB5</code> </li>
<li>Timer <code>TIM3</code> using pins <code>PA6</code> and <code>PA7</code> </li>
<li>Timer <code>TIM4</code> using pins <code>PB6</code> and <code>PB7</code> </li>
<li>Timer <code>TIM8</code> using pins <code>PC6</code> and <code>PC7</code> </li>
</ul>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="af12a9e4c2a45e9d096d0611a0cbc7589" name="af12a9e4c2a45e9d096d0611a0cbc7589"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af12a9e4c2a45e9d096d0611a0cbc7589">&#9670;&nbsp;</a></span>STM32Encoder()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STM32Encoder::STM32Encoder </td>
          <td>(</td>
          <td class="paramtype">TIM_TypeDef *&#160;</td>
          <td class="paramname"><em>timer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>pin1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>pin2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set up an STM32 timer to read a quadrature encoder. </p>
<p >This class prepares an STM32 timer in quadrature encoder reading mode, counting on each transition of either channel. It only works on timers whose hardware is quadrature compatible; check the data sheet to see which are. Each compatible timer must have the encoder connected to its channel 1 and 2 inputs; these inputs can only be connected to specific pins. For most timers there are two sets of pins from which we can choose. The alternate function tables in the STM32xxx data sheet shows which pins may be used with each timer.</p>
<p >This class has been tested on an STM32L476RG and may or may not work on other STM32 processors; see the TODO in the constructor.</p>
<p ><b>Example:</b> </p><div class="fragment"><div class="line"><a class="code hl_class" href="class_s_t_m32_encoder.html">STM32Encoder</a> timer_X (TIM3, PB4, PB5);      <span class="comment">// Set up once</span></div>
<div class="line">...</div>
<div class="line">int16_t where_am_I = timer_X.getCount ();   <span class="comment">// In a loop</span></div>
<div class="ttc" id="aclass_s_t_m32_encoder_html"><div class="ttname"><a href="class_s_t_m32_encoder.html">STM32Encoder</a></div><div class="ttdoc">Class which operates an STM32 timer in quadrature encoder mode.</div><div class="ttdef"><b>Definition:</b> encoder_counter.h:35</div></div>
</div><!-- fragment --> <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">timer</td><td>A pointer to a <code>TIM_TypeDef</code> object, such as <code>TIM3</code>, which designates the timer to be used </td></tr>
    <tr><td class="paramname">pin1</td><td>The pin to be configured for use with timer channel 1 </td></tr>
    <tr><td class="paramname">pin2</td><td>The pin to be configured for use with timer channel 2 </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="aaa81c6d6736667b165ccf81f1f417dc8" name="aaa81c6d6736667b165ccf81f1f417dc8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa81c6d6736667b165ccf81f1f417dc8">&#9670;&nbsp;</a></span>getCount()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t STM32Encoder::getCount </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the current position count from the timer. </p>
<dl class="section return"><dt>Returns</dt><dd>The value in the timer's count register </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>waterSenseLibraries/ME507-Support/examples/<a class="el" href="encoder__counter_8h_source.html">encoder_counter.h</a></li>
<li>waterSenseLibraries/ME507-Support/examples/<a class="el" href="encoder__counter_8cpp.html">encoder_counter.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="class_s_t_m32_encoder.html">STM32Encoder</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
</body>
</html>
